---
#
# edX Configuration
#
# github:     https://github.com/edx/configuration
# wiki:       https://openedx.atlassian.net/wiki/display/OpenOPS
# code style: https://openedx.atlassian.net/wiki/display/OpenOPS/Ansible+Code+Conventions
# license:    https://github.com/edx/configuration/blob/master/LICENSE.TXT
#
#
#
# Tasks for role discovery
#
# Overview: This role's tasks come from edx_django_service.
#
#
# Dependencies:
#
#
# Example play:
#
#

- name: Create demo data
  shell: './manage.py create_or_update_partner --site-id 1 --site-domain {{ DISCOVERY_URL_ROOT.split("://")[1] }} --code edx --name edX --courses-api-url "{{ DISCOVERY_LMS_URL_ROOT }}/api/courses/v1/" --ecommerce-api-url "{{ DISCOVERY_ECOMMERCE_URL_ROOT }}/api/v2/" --organizations-api-url "{{ DISCOVERY_LMS_URL_ROOT }}/api/organizations/v0/" --oidc-url-root "{{ DISCOVERY_LMS_URL_ROOT }}/oauth2" --oidc-key {{ DISCOVERY_SOCIAL_AUTH_EDX_OIDC_KEY }} --oidc-secret {{ DISCOVERY_SOCIAL_AUTH_EDX_OIDC_SECRET }}'
  args:
    chdir: "{{ discovery_code_dir }}"
  become_user: "{{ discovery_user }}"
  environment: "{{ discovery_environment }}"
  when: discovery_create_demo_data
  tags:
    - install
