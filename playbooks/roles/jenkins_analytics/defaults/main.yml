---

# See README.md for variable descriptions

ANALYTICS_SCHEDULE_SECURE_REPO_URL:
ANALYTICS_SCHEDULE_SECURE_REPO_DEST: "analytics-secure-config"
ANALYTICS_SCHEDULE_SECURE_REPO_VERSION: "master"
ANALYTICS_SCHEDULE_SECURE_REPO_CREDENTIAL_ID:
# If EXTRA_VARS is a file path, it can be relative to the workspace, or absolute.
ANALYTICS_SCHEDULE_EXTRA_VARS: "@{{ ANALYTICS_SCHEDULE_SECURE_REPO_DEST }}/vars.yml"

ANALYTICS_SCHEDULE_JOBS_DSL_REPO_URL: "git@github.com:edx/edx-jenkins-job-dsl.git"
ANALYTICS_SCHEDULE_JOBS_DSL_REPO_VERSION: "master"
ANALYTICS_SCHEDULE_JOBS_DSL_REPO_CREDENTIAL_ID:
ANALYTICS_SCHEDULE_JOBS_DSL_CLASSPATH: |
  src/main/groovy
  lib/*.jar
ANALYTICS_SCHEDULE_JOBS_DSL_TARGET_JOBS: "jobs/analytics-edx-jenkins.edx.org/*Jobs.groovy"

JENKINS_ANALYTICS_USER_PASSWORD_HASHED: $6$rAVyI.p2wXVDKk5w$y0G1MQehmHtvaPgdtbrnvAsBqYQ99g939vxrdLXtPQCh/e7GJVwbnqIKZpve8EcMLTtq.7sZwTBYV9Tdjgf1k.
JENKINS_ANALYTICS_USER_PASSWORD_PLAIN: jenkins

JENKINS_ANALYTICS_CREDENTIALS:
  - id: github-deploy-key
    scope: GLOBAL
    username: git
    type: ssh-private-key
    passphrase: null
    description: Autogenerated by ansible
    privatekey: "{{ JENKINS_ANALYTICS_GITHUB_KEY }}"

JENKINS_ANALYTICS_CONCURRENT_JOBS_COUNT: 2

jenkins_credentials_file: ansible-jenkins-credentials.json
jenkins_connection_retries: 240
jenkins_connection_delay: 1
jenkins_auth_realm:
  name: unix
  service: su
  # Change this default password: (see README.md to see how you can do it)
  plain_password: "{{ JENKINS_ANALYTICS_USER_PASSWORD_PLAIN }}"
  hashed_password: "{{ JENKINS_ANALYTICS_USER_PASSWORD_HASHED }}"

# For now only a single seed job is supported, adding more would require
# Ansible 2.+ or converting _execute_jenkins_cli to a module
jenkins_seed_job:
  name: ANALYTICS_SEED
  parameters:
    - extra_vars:
      name: EXTRA_VARS
      value: "{{ ANALYTICS_SCHEDULE_EXTRA_VARS }}"
      description: "Seed Job configuration"
    - git_credentials:
      name: GIT_CREDENTIAL_ID
      value: "{{ ANALYTICS_SCHEDULE_SECURE_REPO_CREDENTIAL_ID | default('') }}"
      description: "Credentials for cloning the git repos"
  multiscm:
    - scm:
      type: git
      url: "{{ ANALYTICS_SCHEDULE_JOBS_DSL_REPO_URL }}"
      dest: ""
      branch: "{{ ANALYTICS_SCHEDULE_JOBS_DSL_REPO_VERSION | default('master') }}"
      credential_id: "{{ ANALYTICS_SCHEDULE_JOBS_DSL_REPO_CREDENTIAL_ID | default('') }}"
    - scm:
      type: git
      url: "{{ ANALYTICS_SCHEDULE_SECURE_REPO_URL | default('') }}"
      dest: "{{ ANALYTICS_SCHEDULE_SECURE_REPO_DEST | default('') }}"
      branch: "{{ ANALYTICS_SCHEDULE_SECURE_REPO_VERSION | default('master') }}"
      credential_id: "{{ ANALYTICS_SCHEDULE_SECURE_REPO_CREDENTIAL_ID | default('') }}"
  dsl:
    removed_view_action: IGNORE
    removed_job_action: DELETE
    additional_classpath: "{{ ANALYTICS_SCHEDULE_JOBS_DSL_CLASSPATH }}"
    target_jobs: "{{ ANALYTICS_SCHEDULE_JOBS_DSL_TARGET_JOBS }}"
