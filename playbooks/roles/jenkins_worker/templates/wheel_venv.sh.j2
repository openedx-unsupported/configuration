#! /usr/bin/env bash

if [ $# -ne 1 ]; then
    echo "Usage: $0 VENV_DIR"
    exit 1
fi

VENV=$1

if [ ! -d "$VENV" ]; then

    # Create and activate the new virtualenv
    mkdir -p $VENV
    /usr/local/bin/virtualenv $VENV
    source $VENV/bin/activate

    # Install each available wheel archive
    ls {{ jenkins_wheel_dir }} | cut -d- -f1 | while read line ; do
        pip install --use-wheel --no-index --find-links={{ jenkins_wheel_dir }} $line ;
    done

else
    echo "virtualenv $VENV already exists, skipping..."
fi
